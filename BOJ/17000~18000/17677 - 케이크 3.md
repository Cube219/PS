---
author: Cube219
created: 2023-12-17T17:54:42+09:00
updated: 2023-12-17T17:54:42+09:00
---

[17677번: 케이크 3](https://www.acmicpc.net/problem/17677)

# 풀이

* 만약 M개를 뽑았다면, C순으로 정렬하는 것이 이득이다. 정렬된 상태에서 바꾸려고 하면 무조건 손해거나 이득이 없기 때문이다. 그러면 인접한 C의 차이의 합은 맨 처음과 끝 C값에 의해서만 결정되며, 이 값은 2*(Cn-C1)이 된다.
* Subtask2는 처음과 끝을 고정시키고 중간에 V순으로 M-2개의 최댓값을 구하면 된다. 이는 priority queue를 이용하면 O(N^2*logN)에 된다. 문제는 N<=200000이라는 것이다. 생각해보면, r을 고정시켰을 때 최적의 범위가 l이라 하면, r-1일 때 최적의 범위는 무조건 l보다 작거나 같아야 한다.
* 만약 r-1일 때 최적의 범위가 l+1이라면, 역으로 r을 고정시켰을 때 최적의 범위는 l+1이 되므로 모순되기 때문이다(확실한 증명은 아님). 이것으로 DnC Optimization을 사용할 수 있다. 이제 구간에서 M-2개의 최댓값을 구하는 것이 문제다.
* 여기서 조금 특이한 테크닉을 쓰는데, DnC Opt를 할 때 DFS를 쓰지 않고 BFS처럼 하는 것이다. 그리고 분할정복 깊이마다 묶어서 처리를 한다. 이러면 j의 범위가 겹치지 않게(끝부분 제외) 이동하게 된다.
* 그러면 (범위 오른쪽에 추가/왼쪽에 제거) 이 2가지 연산만 처리하면 된다. 이것은 세그트리 2개(sum, cnt)로 구현할 수 있다. 범위를 고정시키면 맨 왼쪽/오른쪽은 무조건 포함되어야 하므로 그 사이 M-2개의 최댓값을 구하는 것에 주의.