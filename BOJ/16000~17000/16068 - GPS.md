---
author: Cube219
created: 2022-12-18T23:36:37+09:00
updated: 2022-12-18T23:36:37+09:00
---

[16068번: GPS](https://www.acmicpc.net/problem/16068)

# 풀이

GPS 신호가 도달가능한가 여부는, 위성과 지구의 접선의 길이보다 작은지로 확인하면 된다. 이제 길이를 구해야 하므로, 직교좌표계로 바꿔보자. 내 위치는 구면좌표계이기 때문에 바로 바꿀 수 있다. 위성이 문제인데, 일단 reference longitude는 xy평면 회전변환이므로 가장 마지막에 처리하자.

![|450](attachments/Pasted%20image%2020221218233655.png)

궤도상의 각을 a, 적도와 궤도의 각을 b라 하자. 먼저 xy평면에서 살펴보자. 그러면 궤도는 타원 형태로 나타나는데, 짧은 쪽의 길이는 zy평면을 보면 cos(b)임을 알 수 있고, 그러면 x와 y의 값을 구할 수 있다.

z값은 노란색의 길이를 알면 구할 수 있는데, 이는 궤도를 평면으로 잘라서 보면 sin(a)임을 알 수 있고, z도 구할 수 있게 된다.

x,y,z를 구했으므로 xy평면 회전변환으로 x랑 y값을 수정하고 길이를 구하면 된다.
