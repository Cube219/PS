---
author: Cube219
created: 2023-12-24T16:45:13+09:00
updated: 2023-12-24T16:45:13+09:00
---

[25564번: 역삼역](https://www.acmicpc.net/problem/25564)

# 풀이

* 서로 다른 부분 문자열을 구하는 문제는 Suffix Array와 LCP를 이용하는 방법이 있다. SA가 suffix들이기 때문에, SA의 모든 prefix들이 모든 부분 문자열이 된다. 여기서 현재 SA의 LCP부분만 스킵하면 서로 다른 부분문자열이 된다.
* 팰린드롬에서 K이상은 K, K+1로 줄여서 생각해보자. 만약 어떤 suffix를 기준으로, prefix를 늘리다가 팰림드롬을 덮으면, 뒤에 있는 prefix들도 이 팰린드롬을 덮게 된다.
* 따라서 현재 suffix를 기준으로 가장 앞에 있는 팰린드롬을 찾고, 덮어지는 위치와 LCP를 고려하면 현재 suffix중 만족하는 prefix의 개수를 빠르게 구할 수 있다.
* 팰린드롬은 Manacher를 이용해 빠르게 구하자. 그리고 K/K+1팰린드롬을 시작점을 기준으로 기록하고, 위치 0부터 시작해서 가장 가까운 팰린드롬을 구하면 된다.