---
author: Cube219
created: 2023-12-03T22:33:44+09:00
updated: 2023-12-03T22:33:44+09:00
---

[25387번: 수열과 쿼리의 부분합의 합](https://www.acmicpc.net/problem/25387)

# 풀이

* 쿼리에 특정한 값으로 덮어씌우는 것은, 최근 코포나 앳코더에서 나온 유형이다. 이것은 map을 이용해 disjoint한 구간들을 관리하면 총 O(QlogQ)에 가능하다. 이 방향으로 접근해보자. 참고: [https://atcoder.jp/contests/abc255/editorial/4115](https://t.co/H9PO02V5zA)
* 일단 U랑 D가 고정되어있다고 생각하자. 특정한 위치 i가 모든 subarray에 등장하는 횟수는 i * (n - i + 1)이다. 이제 각 위치별 등장 횟수를 알았으니, 구간은 prefix sum으로 미리 전처리하면 O(1)에 구할 수 있다.
* map을 이용해 구간을 관리하면, 새로운 구간이 덮어씌워지면서 탈락하는 구간들을 알 수가 있다. 이때 구간에 쿼리 번호를 기록해두면 해당 구간이 언제 생성되고 사라지는지 알 수가 있다.
* 그러면 해당 구간이 쿼리의 subarray들 중에 영향을 끼치는 조건은 (1. 시작 지점을 포함 2. 탈락 지점을 미포함) 이다. 이것은 [1, 탈락지점-1] array에서 시작지점이 등장하는 횟수고, 위의 식과 비슷하게 구할 수 있다. 이제 이 2개와 c값을 곱해주면 된다.
