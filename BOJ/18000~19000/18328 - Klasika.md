---
author: Cube219
created: 2023-12-28T18:38:57+09:00
updated: 2023-12-28T18:38:57+09:00
---

[18328번: Klasika](https://www.acmicpc.net/problem/18328)

# 풀이

* 루트에서 x까지 XOR값을 c[x]라 하자. 그러면 트리에서 a와 b의 XOR값은 그냥 c[a]^c[b] 하면 된다. LCA부분은 어차피 XOR되면서 지워져서 신경을 안 써도 된다.
* 이제 쿼리를 처리해야 하는데, c[a]와 b의 subtree들 중 골라서 최댓값을 구해야 한다.
* 두 XOR의 최댓값을 트라이로 구할 수 있는데([13505번: 두 수 XOR](https://www.acmicpc.net/problem/13505) 참고), 여기에 추가로 subtree인 값만 확인해야 한다. 이것을 위해 트리를 오일러 투어 테크닉으로 번호를 새로 부여하고, 트라이에 값을 넣을 때 이 번호를 트라이에 넣으면 된다.
* 그러면 트라이에서 검색을 할 때 추가로 b의 subtree에 있는지 확인하면 된다. 이것을 set으로 찾아주자.
* 여기서 트라이를 그냥 vector로 하면 reallocation하면서 메모리가 순간적으로 상승해 초과되므로, reserve함수로 적당히 크게 잡아두자. 본인은 4000000으로 잡았다.