---
author: Cube219
created: 2023-12-17T17:48:49+09:00
updated: 2023-12-17T17:48:49+09:00
---

[20581번: Three balls](https://www.acmicpc.net/problem/20581)

# 풀이

* 공의 반지름이 Manhattan distance이고, 각 좌표는 (0,1)이 때문에, 공이 차지하는 좌표는 최대 r개의 비트를 바꾸는 경우다. 세 공이 차지하는 좌표이므로, 포함배제로 접근하자. 1개의 공이 차지하는 좌표의 개수는 [0,r]개의 bit를 선택하는 경우의 수로, 조합을 이용해 쉽게 구할 수 있다.
* 2개의 공이 겹치는 좌표의 개수를 구하자. 두 공의 bit가 다르다면 둘 중 하나의 공에서 바꿔야 하고, 같다면 둘 다 바꾸거나 안 바꿔야 한다. 전자의 경우 한쪽에서 x개를 바꾼다면, 다른쪽에서 k-x개를 바꿔야 한다. 이때 경우의 수는 kCx이다. 이것을 x가 0~k일 때 다 구해주면 된다.
* 은 bit들 중 [0,min(남은r1,남은r2)]를 쓰는 경우의 수를 구하면 된다.
* 3개의 공인 경우 좀 어려운데, 일단 3개 다 같은 bit인 경우는 위와 동일하다. 다른 경우는 (1,0,0),(0,1,0),(0,0,1) 3가지 경우가 나온다. 각각의 개수를 d1,d2,d3라 하고, 1에 해당하는 공이 바꾸는 개수를 x1,x2,x3라 하자. 이것을 이용해 남은 r들을 알 수 있고, 경우의 수들을 구할 수 있다.
* 하지면 이러면 O(N^3)으로 시간초과다. 일단 2개는 고정시키고 생각하자. 여기서 x3를 관찰해보면, x3가 +1되면 남은 r3는 -1이 되고, 남은r1/r2는 +1이 된다. 그러면 min(r1,r2,r3)는 x3이 증가함에 따라서 ^자 모양으로 나오게 된다.
* ^에서 고점은 x3를 제외하고 고정된 숫자기 때문에, 식을 정리하면 구할 수 있다. 고점에 값을 넣어두고 나중에 전파시켜 계산하자. ldp[min(r1,r2,r3)][x3]=해당 지점에서 x1,x2경우의 수 합 으로 정의하자. 양쪽으로 퍼지므로 rdp도 똑같이 만들어주자.
* 큰 값부터 순회하면서 경우의 수를 구해주고, ldp[v-1][x3-1]+=ldp[v][x3], rdp[v-1][x3+1]+=rdp[v][x3] 이렇게 전파시키면 된다. 여기서 dp배열이 메모리를 많이 잡아먹으므로, 3에 해당하는 경우는 3가지 경우 중 가장 작은 경우로 선택하자.